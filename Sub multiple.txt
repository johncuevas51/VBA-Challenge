Sub multiple_year_challenge()Dim sh As Worksheet'loop through all worksheetsFor Each sh In ThisWorkbook.Worksheets    sh.Select' Set an initial variables for the ticker, yearly_change, percent_change, total_volDim ticker As StringDim yearlychange As DoubleDim percentchange As DoubleDim totalvolume As LongLongDim Summary_Table_Row As DoubleDim open_price As DoubleDim close_price As Doubleyearlychange = 0percentchange = 0totalvolume = 0Summary_Table_Row = 2    LastRow = Cells(Rows.Count, 1).End(xlUp).Row        sh.Range("J1").Value = "Ticker"    sh.Range("K1").Value = "Yearly Change"    sh.Range("L1").Value = "Percent Change"    sh.Range("M1").Value = "Total Stock Volume"        'Loop for summary table    For i = 2 To LastRow        'If statements to determine open and close price for the year        If Right(Cells(i, 2), 4) = "0102" Then            open_price = Cells(i, 3)        End If        If Right(Cells(i, 2), 4) = "1231" Then            close_price = Cells(i, 6)        End If        'Check if you are still within same ticker        If Cells(i + 1, 1).Value <> Cells(i, 1).Value Then                    'Set ticker column            ticker = Cells(i, 1).Value                        'Set yearly_change            yearlychange = close_price - open_price                        'Set percent_change            percentchange = yearlychange / open_price                    ' Add to the total_vol            totalvolume = totalvolume + Cells(i, 7).Value                        ' Print the ticker in the Summary Table            Range("J" & Summary_Table_Row).Value = ticker                        ' Print the yearly_change in the Summary Table            Range("K" & Summary_Table_Row).Value = yearlychange                        'Color Formatting            If yearlychange < 0 Then               Range("k" & Summary_Table_Row).Interior.ColorIndex = 3                Else                    Range("k" & Summary_Table_Row).Interior.ColorIndex = 4            End If                        ' Print the yearly_change in the Summary Table            Range("L" & Summary_Table_Row).Value = percentchange            Range("L" & Summary_Table_Row).NumberFormat = "0.00%"            'Print the total_vol in the Summary Table            Range("M" & Summary_Table_Row).Value = totalvolume                        ' Add one to the summary table row            Summary_Table_Row = Summary_Table_Row + 1                        ' Reset the total_vol            totalvolume = 0            yearlychange = 0                ' If next cell is same ticker         Else            ' Add to the total_vol            totalvolume = totalvolume + Cells(i, 7).Value                End If        Next iNext shEnd Sub